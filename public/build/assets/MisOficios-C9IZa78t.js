import{X as oe,r as t,G as P,j as e,S as re,x as f}from"./app-SAu7cWnM.js";import{A as ne,p as le,g as ce}from"./pageHeader-Bm3VSx5g.js";/* empty css                     */import{E as p,l as b,$ as v,D as de}from"./es-MX-mu63uRgm.js";import{V as ue}from"./VerPdf-CDnx7QHx.js";import{S as k}from"./react-select.esm-9n8q26Th.js";import S from"./InputError-BaCOBtok.js";import{R as C,B as i,c as D}from"./index-D1VehZEk.js";import{S as me}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{L as fe}from"./LineaTiempo-BjDRyItg.js";import{C as c}from"./Col-Cl0reMBM.js";import{C as g}from"./Card-XCKjLKBL.js";import{T as pe,a as N}from"./Tabs-CfNXwC-S.js";import{M as F,a as V,b as A,c as B,d as E}from"./Modal-DfOfDXzC.js";import{F as y}from"./Form-B4-XBAy3.js";import"./commonimages-Dkej4Z42.js";import"./CloseButton-CH4nP8FD.js";import"./ElementChildren-BKfxMiEx.js";p.use(de);function Be({status:he,oficios:h,usuariosSelect:O,procesos:L,nuevos:T}){const d=oe().props.auth.user,[M,n]=t.useState(!1),[H,x]=t.useState(!1),[$,j]=t.useState(!1),[K,z]=t.useState(!1),[W,I]=t.useState([]),[_,w]=t.useState({textoRechazo:""}),[o,l]=t.useState({urlPdf:"",extension:"",idOfico:0}),R=t.useRef(null),[U,q]=t.useState(),[G,X]=t.useState(),[J,Q]=t.useState();t.useEffect(()=>{q((h||[]).filter(s=>s.archivo_respuesta===null&&s.id_area!="1").map(s=>({...s}))),X((h||[]).filter(s=>s.archivo_respuesta!==null&&s.id_area!="1").map(s=>({...s}))),Q((h||[]).filter(s=>s.id_area==="1").map(s=>({...s})))},[h]);const r=P({id:"",proceso_impacta:"",usuario:""}),Y=s=>{s.preventDefault(),r.post(route("oficioAsignaResponsable"),{onSuccess:ae})},u=P({id:0,descripcion:""}),Z=s=>{s.preventDefault(),me.fire({title:"¿Está seguro?",text:"Se notificará al jefe de área y ya no podrá ver el oficio",icon:"warning",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Sí, estoy seguro",denyButtonText:"Cancelar",customClass:{container:"swalSuperior"}}).then(a=>{a.isConfirmed?u.post(route("rechazaOFicio"),{onSuccess:se}):u.cancel()})},ee=async s=>{r.clearErrors(),r.setData("id",s.id),I(L),setTimeout(()=>{R.current.setValue({value:s.proceso_impacta,label:s.proceso},"select-option")},200),x(!0)},ae=()=>{r.reset(),x(!1),D("Correcto: Se asigno un responsable al oficio.",{style:{padding:"25px",color:"#fff",backgroundColor:"#29bf74"},position:"top-center"})},se=()=>{u.reset(),j(!1),D("Correcto: Se rechazo el oficio.",{style:{padding:"25px",color:"#fff",backgroundColor:"#29bf74"},position:"top-center"})};return e.jsxs(ne,{children:[e.jsxs(re,{children:[e.jsx("title",{children:"Mis oficios"}),e.jsx("meta",{name:"listado de mis oficios asignados",content:"Lista de oficios asignados"})]}),e.jsxs(t.Fragment,{children:[e.jsx(le,{titles:"Listado de oficios",active:"Listado de oficios",items:[]}),e.jsx(C,{children:e.jsx(c,{lg:12,md:12,children:e.jsxs(g,{children:[e.jsxs(g.Header,{className:"d-flex justify-content-between",children:[e.jsx(g.Title,{as:"h3",children:"Mis oficios asignados"}),e.jsxs("div",{className:"tags",children:[e.jsx("span",{className:"tag tag-radius tag-round tag-verde",children:"Se dio respuesta en tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-amarillo",children:"Sin respuesta, en tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-naranja",children:"Sin respuesta, fuera de tiempo"}),e.jsx("span",{className:"tag tag-radius tag-round tag-rojo",children:"Se dio respuesta fuera de tiempo"})]}),e.jsx("div",{className:"tags"})]}),e.jsx(g.Body,{children:e.jsx("div",{className:"panel panel-default",children:e.jsxs(pe,{defaultActiveKey:"tab1",children:[e.jsx(N,{eventKey:"tab1",title:"Activos",children:e.jsx(c,{md:12,className:"table-responsive",children:e.jsx(p,{data:U,options:{language:b,autoWidth:!1},columns:[{data:"id",title:"Estatus",createdCell(s,a,m,ie,te){v(s).css("background",m.color),v(s).css("color",m.color)},width:"5%"},{data:"f_ingreso",title:"Fecha de ingreso",width:"10%"},{data:"numero_oficio",title:"No. Oficio / Folio",width:"5%"},{data:"responsable",title:"Responsable",width:"10%"},{data:"proceso",title:"Proceso",width:"10%"},{data:"descripcion",title:"Breve descripción",width:"40%"},{data:"proceso",width:"15%",title:"Acciones"}],className:"display table-bordered  border-bottom ancho100",slots:{6:(s,a)=>e.jsxs("div",{className:"text-center",children:[a.respuesta>0&&a.finalizado===null&&d.rol==3?e.jsx(f,{href:route("viewRespOficio",{id:a.id}),children:e.jsxs(i,{className:"btn-icon btn btn-warning mr-1",variant:"primary",title:"Revisar respuesta",children:[e.jsx("i",{className:"zmdi zmdi-pin-account"})," "]})}):null,a.respuesta==0?e.jsx(f,{href:route("oficioResponder",{id:a.id}),style:{color:"white"},hidden:a.id_usuario!==null&&d.rol==3,children:e.jsx(i,{className:"btn-icon btn btn-warning",variant:d.rol==4&&(a.descripcion_rechazo_jefe!==null||a.descripcion_rechazo_final!==null)?"danger":"warning",title:"Responder al oficio",children:e.jsx("i",{className:"fa fa-mail-reply"})})}):e.jsx(i,{className:"btn-icon btn btn-warning",variant:"danger",title:"Ver respuesta al oficio",onClick:()=>{l({...o,urlPdf:`imprime/pdf/0/${a.id}`,extension:"pdf"}),n(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),d.rol==3||d.rol==1?e.jsx(i,{className:"btn-icon btn ml-1",variant:a.descripcion_rechazo===null?"primary":"danger",title:a.descripcion_rechazo===null?"Asignar responsable":"Reasignar un responsable",onClick:()=>{ee(a),w({..._,textoRechazo:a.descripcion_rechazo})},hidden:a.id_usuario!==null||a.respuesta>0,children:e.jsx("i",{className:"fa fa-male"})}):e.jsx(i,{className:"btn-icon btn ml-1",variant:"primary",title:"Rechazar responsabilidad",onClick:()=>{u.setData("id",a.id),j(!0)},disabled:a.respuesta!=0,children:e.jsx("i",{className:"fa fa-times"})}),e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{l({...o,urlPdf:a.archivo,extension:"pdf"}),n(!0)},children:e.jsx("i",{className:"fa fa-eye"})})]})}})})}),e.jsx(N,{eventKey:"tab2",title:"Histórico",children:e.jsx(c,{md:12,className:"table-responsive",children:e.jsx(p,{data:G,options:{language:b,autoWidth:!1},columns:[{data:"id",title:"Estatus",createdCell(s,a,m,ie,te){v(s).css("background",m.color),v(s).css("color",m.color)}},{data:"f_ingreso",title:"Fecha de ingreso"},{data:"des",title:"Ingreso"},{data:"destinatario",title:"Destinatario"},{data:"numero_oficio",title:"No. Oficio / Folio"},{data:"area",title:"Área"},{data:"proceso",title:"Proceso"},{data:"descripcion",title:"Breve descripción"},{data:"proceso",title:"Acciones"}],className:"display table-bordered  border-bottom ancho100",slots:{8:(s,a)=>e.jsxs("div",{className:"text-center",children:[e.jsx(i,{className:"btn-icon btn btn-warning",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{l({...o,urlPdf:a.archivo_respuesta,extension:a.extension}),n(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),e.jsx(i,{className:"btn-icon btn btn-warning ml-1",variant:"danger",title:"Ver respuesta al oficio",onClick:()=>{l({...o,urlPdf:`imprime/pdf/0/${a.id}`,extension:"pdf"}),n(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),e.jsx(i,{className:"btn-icon ml-1",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{l({...o,urlPdf:a.archivo,extension:"pdf"}),n(!0)},children:e.jsx("i",{className:"fa fa-eye"})}),e.jsx(i,{className:"btn-icon ml-1",variant:"success",onClick:()=>{l({...o,idOfico:a.id}),z(!0)},title:"Ver línea de tiempo del oficio",children:e.jsx("i",{className:"fa fa-history"})})]})}})})}),e.jsx(N,{eventKey:"tab3",title:"Informativos",children:e.jsx(c,{md:12,className:"table-responsive",children:e.jsx(p,{data:J,options:{language:b,autoWidth:!1},columns:[{data:"f_ingreso",title:"Fecha de ingreso",width:"10%"},{data:"numero_oficio",title:"No. Oficio / Folio",width:"5%"},{data:"descripcion",title:"Breve descripción",width:"40%"},{data:"proceso",width:"15%",title:"Acciones"}],className:"display table-bordered  border-bottom ancho100",slots:{3:(s,a)=>e.jsx("div",{className:"text-center",children:e.jsx(i,{className:"btn-icon ",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{l({...o,urlPdf:a.archivo,extension:"pdf"}),n(!0)},children:e.jsx("i",{className:"fa fa-eye"})})})}})})}),e.jsx(N,{eventKey:"tab4",title:"Oficios VD",children:e.jsx(c,{md:12,className:"table-responsive",children:e.jsx(p,{data:T,options:{language:b,autoWidth:!1},columns:[{data:"f_ingreso",title:"Fecha de creación",width:"10%"},{data:"area",title:"Área",width:"10%"},{data:"destinatario",title:"Destinatario",width:"10%"},{data:"id",width:"15%",title:"Acciones"}],className:"display table-bordered  border-bottom ancho100",slots:{3:(s,a)=>e.jsxs("div",{className:"text-center",children:[a.revision>0&&a.finalizado===null&&d.rol==3&&a.id_usuario!==null?e.jsx(f,{href:route("viewRespNuevoOficio",{id:a.id}),children:e.jsxs(i,{className:"btn-icon btn btn-warning mr-1",variant:"primary",title:"Revisar respuesta",children:[e.jsx("i",{className:"zmdi zmdi-pin-account"})," "]})}):null,a.archivo_respuesta===null?null:e.jsx(i,{className:"btn-icon btn btn-warning mr-1",variant:"danger",title:"Ver confirmación de recibido",onClick:()=>{l({...o,urlPdf:a.archivo_respuesta,extension:a.extension}),n(!0)},children:e.jsx("i",{className:"fa fa-file-pdf-o"})}),d.rol==3&&a.id_usuario===null&&a.finalizado===null&&a.enviado===null?e.jsx(f,{href:route("nuevoOficio",{id:a.id}),style:{color:"white"},children:e.jsx(i,{className:"btn-icon btn btn-warning mr-1",variant:a.descripcion_rechazo_final!==null?"danger":"warning",title:"editar el oficio",children:e.jsx("i",{className:"fa fa-mail-reply"})})}):null,d.rol==4&&a.id_usuario!==null&&a.finalizado===null&&a.enviado===null?e.jsx(f,{href:route("nuevoOficio",{id:a.id}),style:{color:"white"},children:e.jsx(i,{className:"btn-icon btn btn-warning mr-1",variant:a.descripcion_rechazo_final!==null||a.descripcion_rechazo_jefe!==null?"danger":"warning",title:"editar el oficio",children:e.jsx("i",{className:"fa fa-mail-reply"})})}):null,a.masivo==1&&a.archivo!==null&&a.archivo.substring((a==null?void 0:a.archivo.length)-3)!=="pdf"?e.jsx(i,{className:"btn-icon",variant:"primary",title:"Ver Word del oficio",onClick:()=>{window.open(ce(`/files/${a.archivo}`),"_blank")},children:e.jsx("i",{className:"fa fa-eye"})}):e.jsx(i,{className:"btn-icon ",variant:"danger",title:"Ver PDF del oficio",onClick:()=>{l({...o,urlPdf:a.masivo==1?a.archivo:`imprime/nuevo/pdf/${a.id}`,extension:"pdf"}),n(!0)},children:e.jsx("i",{className:"fa fa-eye"})})]})}})})})]})})})]})})}),e.jsx(ue,{urlPdf:o.urlPdf,show:M,tipo:o.extension,setShow:n}),e.jsx(fe,{showLinea:K,setShowLinea:z,id:o.idOfico}),e.jsxs(F,{size:"xl",show:H,onHide:()=>x(!1),children:[e.jsx(V,{children:e.jsx(A,{as:"h5",children:"Asignación de responsable"})}),e.jsxs("form",{onSubmit:Y,children:[e.jsx(B,{children:e.jsxs(C,{children:[_.textoRechazo!==null?e.jsxs(c,{xs:12,children:[e.jsx(y.Label,{children:"Breve descripción del rechazo por parte del colaborador:"}),e.jsx("textarea",{className:"form-control",value:_.textoRechazo,rows:3,disabled:!0})]}):null,e.jsxs(c,{xs:12,sm:6,xl:4,children:[e.jsx(y.Label,{children:"Proceso al que impacta"}),e.jsx(k,{classNamePrefix:"Select",options:W,ref:R,name:"proceso_impacta",className:r.errors.proceso_impacta?"inputError":"",defaultValue:r.data.proceso_impacta,onChange:s=>r.setData("proceso_impacta",s==null?void 0:s.value),placeholder:"Seleccione una opción"}),e.jsx(S,{className:"mt-1",message:r.errors.proceso_impacta})]}),e.jsxs(c,{xs:12,sm:6,xl:4,children:[e.jsx(y.Label,{children:"Usuario responsable"}),e.jsx(k,{classNamePrefix:"Select",options:O,name:"usuario",className:r.errors.usuario?"inputError":"",defaultValue:r.data.usuario,onChange:s=>r.setData("usuario",s==null?void 0:s.value),placeholder:"Seleccione una opción"}),e.jsx(S,{className:"mt-1",message:r.errors.usuario})]})]})}),e.jsxs(E,{children:[e.jsx(i,{variant:"secondary",onClick:()=>x(!1),children:"Cancelar"}),e.jsx(i,{variant:"primary",type:"submit",children:"Asignar responsable"})]})]})]}),e.jsxs(F,{show:$,onHide:()=>j(!1),children:[e.jsx(V,{children:e.jsx(A,{as:"h5",children:"Rechazar Oficio"})}),e.jsxs("form",{onSubmit:Z,children:[e.jsx(B,{children:e.jsx(C,{children:e.jsxs(c,{xs:12,children:[e.jsx(y.Label,{children:"Breve descripción del motivo del rechazo:"}),e.jsx("textarea",{className:u.errors.descripcion?"form-control inputError":"form-control",name:"descripcion",value:u.data.descripcion,onChange:s=>u.setData("descripcion",s.target.value),placeholder:"Máximo 500 caracteres",rows:2}),e.jsx(S,{className:"mt-1",message:u.errors.descripcion})]})})}),e.jsxs(E,{children:[e.jsx(i,{variant:"secondary",onClick:()=>j(!1),children:"Cancelar"}),e.jsx(i,{variant:"primary",type:"submit",children:"Rechazar oficio"})]})]})]})]})]})}export{Be as default};
